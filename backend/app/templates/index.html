<!DOCTYPE html>
<html>
<head>
    <title>Finance App</title>
    <style>
        body { font-family: Arial; margin: 40px; }
        input { margin: 5px; }
        button { margin: 5px; }
        .box { margin-bottom: 20px; padding: 15px; border: 1px solid #ccc; }
    </style>
</head>
<body>

<h1>Finance App Test UI</h1>

<div class="box">
    <h2>Register</h2>
    <input id="reg_email" placeholder="Email">
    <input id="reg_password" type="password" placeholder="Password">
    <button onclick="register()">Register</button>
</div>

<div class="box">
    <h2>Login</h2>
    <input id="login_email" placeholder="Email">
    <input id="login_password" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
</div>

<div class="box">
    <h2>Get Users</h2>
    <button onclick="getUsers()">Fetch Users</button>
    <pre id="users_output"></pre>
</div>

<script>

let token = null;

async function register() {
    const email = document.getElementById("reg_email").value;
    const password = document.getElementById("reg_password").value;

    const response = await fetch("/users/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
    });

    const data = await response.json();
    alert(JSON.stringify(data, null, 2));
}

async function login() {
    const email = document.getElementById("login_email").value;
    const password = document.getElementById("login_password").value;

    const response = await fetch("/users/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
    });

    const data = await response.json();

    token = data.access_token;
    alert("Token guardado en memoria");
}

async function getUsers() {
    const response = await fetch("/users/");
    const data = await response.json();
    document.getElementById("users_output").textContent =
        JSON.stringify(data, null, 2);
}

</script>

</body>
</html>
